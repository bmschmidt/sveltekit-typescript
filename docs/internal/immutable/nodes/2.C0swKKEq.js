import{c as Le,a as S,t as M}from"../chunks/disclose-version.DDrOHCmQ.js";import{i as he}from"../chunks/legacy.TA_ayKnr.js";import{as as Ne,b as me,h as y,a9 as ge,at as Me,au as C,a as L,a1 as we,U as ie,c as D,A as $,X as Y,K as oe,Z as fe,av as le,al as P,am as U,ap as Re,g as Oe,ag as Ue,a8 as V,a3 as qe,I as He,ae as Ee,aj as Be,ak as ue,a7 as z,aa as We,aw as q,F as ce,ax as $e,ad as Pe,ay as Fe,d as Ge,_ as Ke,az as Q,aA as be,aB as j,aC as Ve,a5 as ze,aD as Je,H as Xe,aE as Ye,p as ke,f as Z,w as H,t as B,k as E,x as N,v as F,Q as ve,e as ye,aF as Ze,aG as Qe,C as de,aH as je}from"../chunks/runtime.CoQ7hKXU.js";import{s as W,e as ea}from"../chunks/render.D4oYIA4h.js";import{_ as aa,p as Ae}from"../chunks/preload-helper.sQ-3-82f.js";import{b as ra}from"../chunks/paths.CUJp4_nD.js";const J=0,O=1,X=2;function Te(r,e,a,s,o){y&&ge();var i=r,f=Ne(),w=Oe,u=ie,h,t,_,g=(f?$:Y)(void 0),n=(f?$:Y)(void 0),l=!1;function d(c,m){l=!0,m&&(oe(b),fe(b),le(w));try{c===J&&a&&(h?P(h):h=L(()=>a(i))),c===O&&s&&(t?P(t):t=L(()=>s(i,g))),c!==J&&h&&U(h,()=>h=null),c!==O&&t&&U(t,()=>t=null),c!==X&&_&&U(_,()=>_=null)}finally{m&&(le(null),fe(null),oe(null),Re())}}var b=me(()=>{if(u!==(u=e())){if(Me(u)){var c=u;l=!1,c.then(m=>{c===u&&(C(g,m),d(O,!0))},m=>{if(c===u)throw C(n,m),d(X,!0),n.v}),y?a&&(h=L(()=>a(i))):we(()=>{l||d(J,!0)})}else C(g,u),d(O,!1);return()=>u=ie}});y&&(i=D)}function xe(r,e){return e}function ta(r,e,a,s){for(var o=[],i=e.length,f=0;f<i;f++)$e(e[f].e,o,!0);var w=i>0&&o.length===0&&a!==null;if(w){var u=a.parentNode;Pe(u),u.append(a),s.clear(),x(r,e[0].prev,e[i-1].next)}Fe(o,()=>{for(var h=0;h<i;h++){var t=e[h];w||(s.delete(t.k),x(r,t.prev,t.next)),Ge(t.e,!w)}})}function De(r,e,a,s,o,i=null){var f=r,w={flags:e,items:new Map,first:null},u=(e&be)!==0;if(u){var h=r;f=y?V(qe(h)):h.appendChild(Ue())}y&&ge();var t=null,_=!1;me(()=>{var g=a(),n=He(g)?g:g==null?[]:Ee(g),l=n.length;if(_&&l===0)return;_=l===0;let d=!1;if(y){var b=f.data===Be;b!==(l===0)&&(f=ue(),V(f),z(!1),d=!0)}if(y){for(var c=null,m,k=0;k<l;k++){if(D.nodeType===8&&D.data===We){f=D,d=!0,z(!1);break}var A=n[k],v=s(A,k);m=Se(D,w,c,null,A,v,k,o,e),w.items.set(v,m),c=m}l>0&&V(ue())}if(!y){var p=Ke;na(n,w,f,o,e,(p.f&q)!==0,s)}i!==null&&(l===0?t?P(t):t=L(()=>i(f)):t!==null&&U(t,()=>{t=null})),d&&z(!0),a()}),y&&(f=D)}function na(r,e,a,s,o,i,f,w){var ae,re,te,ne;var u=(o&Je)!==0,h=(o&(j|Q))!==0,t=r.length,_=e.items,g=e.first,n=g,l,d=null,b,c=[],m=[],k,A,v,p;if(u)for(p=0;p<t;p+=1)k=r[p],A=f(k,p),v=_.get(A),v!==void 0&&((ae=v.a)==null||ae.measure(),(b??(b=new Set)).add(v));for(p=0;p<t;p+=1){if(k=r[p],A=f(k,p),v=_.get(A),v===void 0){var Ie=n?n.e.nodes_start:a;d=Se(Ie,e,d,d===null?e.first:d.next,k,A,p,s,o),_.set(A,d),c=[],m=[],n=d.next;continue}if(h&&sa(v,k,p,o),v.e.f&q&&(P(v.e),u&&((re=v.a)==null||re.unfix(),(b??(b=new Set)).delete(v))),v!==n){if(l!==void 0&&l.has(v)){if(c.length<m.length){var R=m[0],T;d=R.prev;var ee=c[0],G=c[c.length-1];for(T=0;T<c.length;T+=1)_e(c[T],R,a);for(T=0;T<m.length;T+=1)l.delete(m[T]);x(e,ee.prev,G.next),x(e,d,ee),x(e,G,R),n=R,d=G,p-=1,c=[],m=[]}else l.delete(v),_e(v,n,a),x(e,v.prev,v.next),x(e,v,d===null?e.first:d.next),x(e,d,v),d=v;continue}for(c=[],m=[];n!==null&&n.k!==A;)(i||!(n.e.f&q))&&(l??(l=new Set)).add(n),m.push(n),n=n.next;if(n===null)continue;v=n}c.push(v),d=v,n=v.next}if(n!==null||l!==void 0){for(var I=l===void 0?[]:Ee(l);n!==null;)(i||!(n.e.f&q))&&I.push(n),n=n.next;var K=I.length;if(K>0){var Ce=o&be&&t===0?a:null;if(u){for(p=0;p<K;p+=1)(te=I[p].a)==null||te.measure();for(p=0;p<K;p+=1)(ne=I[p].a)==null||ne.fix()}ta(e,I,Ce,_)}}u&&we(()=>{var se;if(b!==void 0)for(v of b)(se=v.a)==null||se.apply()}),ce.first=e.first&&e.first.e,ce.last=d&&d.e}function sa(r,e,a,s){s&j&&C(r.v,e),s&Q?C(r.i,a):r.i=a}function Se(r,e,a,s,o,i,f,w,u,h){var t=(u&j)!==0,_=(u&Ve)===0,g=t?_?Y(o):$(o):o,n=u&Q?$(f):f,l={i:n,v:g,k:i,a:null,e:null,prev:a,next:s};try{return l.e=L(()=>w(r,g,n),y),l.e.prev=a&&a.e,l.e.next=s&&s.e,a===null?e.first=l:(a.next=l,a.e.next=l.e),s!==null&&(s.prev=l,s.e.prev=l.e),l}finally{}}function _e(r,e,a){for(var s=r.next?r.next.e.nodes_start:a,o=e?e.e.nodes_start:a,i=r.e.nodes_start;i!==s;){var f=ze(i);o.before(i),i=f}}function x(r,e,a){e===null?r.first=a:(e.next=a,e.e.next=a&&a.e),a!==null&&(a.prev=e,a.e.prev=e&&e.e)}function ia(r,e,a,s){var o=r.__attributes??(r.__attributes={});y&&(o[e]=r.getAttribute(e)),o[e]!==(o[e]=a)&&(a==null?r.removeAttribute(e):typeof a!="string"&&oa(r).includes(e)?r[e]=a:r.setAttribute(e,a))}var pe=new Map;function oa(r){var e=pe.get(r.nodeName);if(e)return e;pe.set(r.nodeName,e=[]);for(var a,s=r,o=Element.prototype;o!==s;){a=Ye(s);for(var i in a)a[i].set&&e.push(i);s=Xe(s)}return e}const fa=!0,la=!1,Sa=Object.freeze(Object.defineProperty({__proto__:null,prerender:fa,ssr:la},Symbol.toStringTag,{value:"Module"})),ua=""+new URL("../assets/duckdb-mvp.DuKjbjvP.wasm",import.meta.url).href,ca=""+new URL("../assets/duckdb-browser-mvp.worker.CM-L3bpJ.js",import.meta.url).href,va=""+new URL("../assets/duckdb-eh.DrTJ_0hP.wasm",import.meta.url).href,da=""+new URL("../assets/duckdb-browser-eh.worker.D6ypKDsm.js",import.meta.url).href;async function _a(){const r=await aa(()=>import("../chunks/duckdb-browser.ae75DZ8L.js"),[],import.meta.url),e={mvp:{mainModule:ua,mainWorker:ca},eh:{mainModule:va,mainWorker:da}},a=await r.selectBundle(e),s=new Worker(a.mainWorker),o=new r.ConsoleLogger,i=new r.AsyncDuckDB(o,s);return await i.instantiate(a.mainModule,a.pthreadWorker),i}var pa=M("<p> </p>"),ha=M("<h1> </h1> <h3> </h3> <!>",1);function ma(r,e){ke(e,!1);let a=Ae(e,"results",8);he();var s=Le(),o=Z(s);Te(o,a,i=>{},(i,f)=>{var w=ha(),u=Z(w),h=H(u,!0);B(()=>W(h,E(f).get(0).year)),N(u);var t=F(u,2);const _=ve(()=>E(f).get(0).president??""),g=ve(()=>E(f).get(0).party??"");var n=H(t);B(()=>W(n,`${E(_)}, ${E(g)}`)),N(t);var l=F(t,2);De(l,1,()=>[...E(f)],xe,(d,b)=>{var c=pa(),m=H(c);N(c),B(()=>{ia(c,"id",`para-${E(b).paragraph??""}`),W(m,`(${E(b).paragraph??""}) ${E(b)["nc:text"]??""}`)}),S(d,c)}),S(i,w)}),S(r,s),ye()}var ga=M('<div id="loading" class="svelte-qfy6rn"></div>');function wa(r){var e=ga();S(r,e)}var Ea=M('<div class="year svelte-19rl3b6"> </div>'),ba=M(`<h1>Duck DB Svelte-kit demo</h1> <div class="description">This is a demo of a static, database-driven page using duckdb WASM. All the primary text is stored
	in a parquet file structured to the <a href="https://nonconsumptive.org">nonconsumptive</a> text sharing
	spec. On load, it gets a copy of duckdb WASM and uses it to mount the parquet file into the database.
	Clicking on any year will load the state of the Union address for that year.</div> <div class="years svelte-19rl3b6"></div> <!>`,1);function Ia(r,e){ke(e,!1);const a=je();Ae(e,"data",8);async function s(){console.log("LOADING DB");const t=await _a();await t.registerFileURL("SOTU.parquet",`${ra}/SOTU.parquet`,4,!1);const _=await t.connect();return await _.query("CREATE TABLE p1 AS SELECT * FROM parquet_scan('SOTU.parquet')"),_}const o=s(),i=[];for(let t=1934;t<2021;t++)i.push(t);async function f(t){const _=await o;de(a,_.query(`
      SELECT * FROM parquet_scan('SOTU.parquet') WHERE year == ${t}
    `)),await E(a)}o.then(()=>f(1936)),Ze(()=>{},()=>{de(a,new Promise(()=>{}))}),Qe(),he();var w=ba(),u=F(Z(w),4);De(u,5,()=>i,xe,(t,_)=>{var g=Ea(),n=H(g,!0);N(g),B(()=>W(n,E(_))),ea("click",g,()=>f(E(_))),S(t,g)}),N(u);var h=F(u,2);Te(h,()=>E(a),t=>{wa(t,{})},(t,_)=>{ma(t,{get results(){return E(a)}})}),S(r,w),ye()}export{Ia as component,Sa as universal};
